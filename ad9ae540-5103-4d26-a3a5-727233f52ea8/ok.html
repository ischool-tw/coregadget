<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title></title>
    <script type="text/javascript" src="js/jquery.min.js"></script>
    <script type="text/javascript" src="js/filedrop.js"></script>

</head>
<body>
    <div id="messages">
        <p>Status Messages</p>
    </div>
    <div id="zone">
    </div>
    <!-- <fieldset id="zone">

    </fieldset> -->

    <fieldset id="status">
        <legend>Status</legend>
        <textarea id="log" cols="30" rows="21" readonly="readonly"></textarea>
        <h3>Last server response to upload</h3>
        <input type="text" id="response" size="200">
    </fieldset>
    <form>
      <div id="zone"></div>
    </form>
    <form>
      <div id="zone2"></div>
    </form>
</body>
</html>
<script type="text/javascript">
$(document).ready(function() {
      function InitDemo() {
        window.fd.onObjCall = function (event, args) {
          var id = '_on' + event.replace(/^./, function (s) { return s.toUpperCase(); });
          fd.SetClass(id, 'ok');

          var log = fd.ByID('log');
          var handlers = this.on[event] ? this.on[event].length : 0;
          var line = '  ' + event + ' event (' + handlers + ' hooks)\n';
          if (log.value.substr(0, line.length) != line) {
            log.value = line + log.value;
          }
        }

        window.ZoneURL = 'http://140.126.57.213/fileUploadManager/uploadFile.ashx';
        window.LastZoneFiles = null;
        // window.OrigZoneHTML = fd.ByID('zone').innerHTML;

        window.Zone = CreateFileDrop('zone');
        window.Zone2 = CreateFileDrop('zone2');
      }

      function CreateFileDrop(id) {
        var zone = new FileDrop(id, {iframe: {url: window.ZoneURL}});
        zone.opt.iframe.force = true;
        SetupFileDrop(zone);
        return zone;
      }

    function SetupFileDrop(zone) {
      zone.on.iframeSetup.push(function () {
        fd.ByID('log').value = '\nSending data via <'+'iframe>...\n\n' + fd.ByID('log').value;
      });

      zone.on.iframeDone.push(function (resp) {
        fd.ByID('response').value = 'IFrame upload response: ' + resp.responseText;
      });

      zone.on.upload.push(function (files) {
        fd.ByID('log').value = '\n傳送中...\n\n' + fd.ByID('log').value;
      });
    }

    function getUrlVars() {
          var vars = [], hash;
          var p = window.location.href.slice(window.location.href.indexOf('?') + 1);
          if (p.indexOf("#") >= 0)
              p = p.substring(0, p.indexOf("#"));
          var hashes = p.split('&');
          for (var i = 0; i < hashes.length; i++) {
              hash = decodeURI(hashes[i]);
              var key = hash.substring(0, hash.indexOf("="));
              vars.push(key);
              vars[key] = hash.substring(hash.indexOf("=") + 1);
          }
          return vars;
      }
      var resp = getUrlVars()["resp"];
      if (resp) {
          alert(decodeURIComponent(resp));
          $('body').append(decodeURIComponent(resp));
      }

InitDemo();

});
</script>